!function($){$.fn.extend({csvExport:function(options){this.defaultOptions={escapeContent:!0,title:"Exported_Table",beforeStart:function(table){},onStringReady:function(currentString){}};let settings=$.extend({},this.defaultOptions,options);return this.each(function(){let $this=$(this),real={x:0,y:0},toExpand={x:[],y:[]},theString="";settings.beforeStart.call(void 0,$this),$("tr",$this).each(function(){let currentTR;$(this).children().each(function(){let currentTD=$(this);spanChecker(),currentTD.is("[colspan]")&&toExpand.x.push({ori:{x:real.x,y:real.y},toDo:+currentTD.attr("colspan"),done:1}),currentTD.is("[rowspan]")&&toExpand.y.push({ori:{x:real.x,y:real.y},toDo:+currentTD.attr("rowspan"),done:1}),theString+='"'+contentCheckup(Array.from(currentTD[0].childNodes).map(e=>e.innerText||e.textContent.replace(/\s/g,"").length?e.textContent:"").join(" ")).replace(/\s+/g," ")+'",',real.x++}),theString=theString.substring(0,theString.length-1),theString+="\r\n",real.x=0,real.y++}),settings.onStringReady.call(void 0,theString);var a=document.createElement("a");function spanChecker(){let colspanHandler=!0;for(;colspanHandler;){let broken=!1;for(let direction of["y","x"]){let other="y"==direction?"x":"y";for(let i=0;i<toExpand[direction].length;i++)if(deleteChecker(toExpand[direction],i)&&i>0&&i--,toExpand[direction].length>0&&real[other]==toExpand[direction][i].ori[other]&&real[direction]==toExpand[direction][i].ori[direction]+toExpand[direction][i].done){theString+='"",',toExpand[direction][i].done++,broken=!0,real.x++;break}}broken||(colspanHandler=!1)}}a.href="data:application/vnd.ms-excel;base64,"+window.btoa(unescape(encodeURIComponent(theString))),a.download=settings.title+".csv",a.click()});function deleteChecker(parent,pos){return parent[pos].toDo==parent[pos].done&&(parent.splice(pos,pos+1),!0)}function contentCheckup(data){return data=data.replace(/\./g,","),settings.escapeContent?data.replace(/([\\"])/g,"\\$1"):data}}})}(jQuery);